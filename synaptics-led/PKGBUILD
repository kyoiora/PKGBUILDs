# Maintainer: Matthew Monaco <dgbaley27@0x01b.net>

_kver=3.1

pkgname=synaptics-led
pkgver=$_kver
pkgrel=1

arch=(i686 x86_64)
license=(GPL2)
url="https://github.com/mmonaco/synaptics-led"
pkgdesc="Synaptics LED enabled psmouse kernel module"
depends=("linux>=3.1" "linux<3.2")
makedepends=("linux-headers")

install=$pkgname.install

source=(
	"ftp://ftp.kernel.org/pub/linux/kernel/v3.x/linux-$_kver.tar.xz"
	"synled.patch"
)

md5sums=(
	edbdc798f23ae0f8045c82f6fa22c536
	57ac8a6ae1656cde97213d4882fa4a87
)

build() {

	cd "$srcdir/linux-$_kver/drivers/input/mouse"
	
	patch -p4 -i "$srcdir/synled.patch"

	make -C "/lib/modules/$(uname -r)/build" M="$PWD" psmouse.ko

	gzip -9 psmouse.ko

	install -Dm 0644 psmouse.ko.gz \
		"$pkgdir/lib/modules/extramodules-$_kver-ARCH/psmouse.ko.gz"
}
